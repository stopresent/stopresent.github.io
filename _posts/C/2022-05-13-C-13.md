---
title: "따라 배우는 C언어 : 13"

categories:
  - C
tags:
  - C

author_profile: false

sidebar:
  nav: "docs"

date: 2022-05-13
last_modified_at: 2022-05-13
---

## 🙇‍♀️13

<br>

### 🪐메모리 레이아웃 훑어보기

* 명령줄 인수와 환경 변수들 Command-line arguments and environment variables
* 스택 Stack (크기 변함)
* 자유 공간 Free
* 힙 Heap (크기 변함)
* 초기화되지 않은 전역/정적 변수들 BSS(Block Started by Symbol) Segment (크기 고정)
* 초기화된 전역/정적 변수들 DATA Segment (크기 고정)
* 프로그램 코드 TEXT Segment (크기 고정)


<br>

### 🪐객체와 식별자, lvalue와 rvalue

객체 : Object

식별자 : Identifier

L-value : left side of an assignment

R-value : right side, variable, constant, expressions


<br>

### 🪐난수 생성기 모듈 만들기 예제

```c
// my_rand.c

static unsigned int next = 1;

int my_rand()
{
	next = next * 1103515245 + 1234;
	next = (unsigned int)(next / 65536) % 32768;

	return (int)next;
}

void my_srand(unsigned int seed)
{
	next = seed;
}
```

```c
// my_rand.h

#pragma once

int my_rand();
void my_srand(unsigned int seed);
```


<br>

### 🪐메모리 동적 할당

```c
int n = 0;

// n from files, internet, scanf, etc.

char* arr = (char*)malloc(sizeof(char) * n);

// ... 

free(arr);
```

<br>

```c
float x;
char str[] = "Dancing with a Star";

int arr[100];

/*
	malloc() returns a void type pointer.
	void* : generic pointer

	free() deallocates the memory
*/

double* ptr = NULL;

ptr = (double*)malloc(30 * sizeof(double));

if (ptr == NULL)
{
	puts("Memory allcation failed.");

	/*
		exit(EXIT_FALURE) is similar to return 1 IN main().
		exit(EXIT_SUCCESS) is similar to return 0 IN main().
	*/

	exit(EXIT_FAILURE);
}

printf("Before free %p\n", ptr);

free(ptr); // no action occurs when ptr is NULL

printf("After free %p\n", ptr);

ptr = NULL; // optional
```

malloc으로 메모리를 할당했으면 꼭 free로 풀어줘야 한다.

ptr이란 변수는 { }을 벗어나면 사라지는데 메모리 할당이 사라진 것은 아니다.

```c
/* Dynamically Allocated Array */

int n = 5;
ptr = (double*)malloc(n * sizeof(double));

if(ptr != NULL) // if(!ptr)
{
	for (int i = 0; i < n; i++)
		printf("%f", ptr[i]);
	printf("\n");

	for (int i = 0; i < n; i++)
		*(ptr + i) = (double)i;

	for (int i = 0; i < n; i++)
		printf("%f", ptr[i]);
	printf("\n");
}

free(ptr);
ptr = NULL;
```

동적할당을 이용한 배열만들기!


<br>

### 🪐메모리 누수와 free()의 중요성
