---
layout: single
title: "C# Rookiss Part4 ê²Œì„ì„œë²„ : ì†Œì¼“ í”„ë¡œê·¸ë˜ë° ì…ë¬¸"
categories: Server
tags: Server
author_profile: false
sidebar:
  nav: "docs"
---


## ğŸ™‡â€â™€ï¸ì†Œì¼“í”„ë¡œê·¸ë˜ë°

* Session : ëŒ€ë¦¬ì¸ íœ´ëŒ€í°
* Socket : ì†ë‹˜ íœ´ëŒ€í°
* ListenerSocket : ë¬¸ì§€ê¸°
* Bind : ë¬¸ì§€ê¸° êµìœ¡
* Listen : ì˜ì—… ì‹œì‘
* Accept : ì•ˆë‚´

* ì‹ë‹¹
  * ë¬¸ì§€ê¸° ê³ ìš©
  * ë¬¸ì§€ê¸° êµìœ¡ - ì‹ë‹¹ì˜ ì£¼ì†Œê¸°ì…, ì…êµ¬ê°€ ì–´ë””ì¸ì§€, í•¸ë“œí°í•˜ë‚˜ë¥¼ ì±™ê²¨ì¤Œ(ì†ë‹˜ì˜ ë¬¸ì˜ ì—°ë½ì„ ëŒ€ê¸°)
  * ì˜ì—… ì‹œì‘
  * ì•ˆë‚´ - ëŒ€ë¦¬ì¸ì˜ ìê²©ìœ¼ë¡œ í•œëª…í•œ í…Œì´ë¸”ë¡œ ì•ˆë‚´í•´ì¤Œ, ì‹ë‹¹ì´ ëŒ€ë¦¬ì¸í•œí…Œ í•¸ë“œí°ì„ ì¤Œ, ë¬¸ì˜ë¥¼ ì¤€ ì†ë‹˜ì´ë‘ ì†Œí†µí•  ìˆ˜ ìˆëŠ” í•¸ë“œí° (ëŒ€ë¦¬ì¸ - ì†ë‹˜  ì†Œí†µê°€ëŠ¥)

* ì†ë‹˜
  * ì†ë‹˜ ê´€ì 
  * ì…ì¥ ë¬¸ì˜ - í•¸ë“œí°ìœ¼ë¡œ ë¬¸ì˜, ì£¼ì†Œì…ë ¥
  * ëŒ€ë¦¬ì¸ ì…ì¥ - í—ˆê°€ ë°›ìœ¼ë©´ ëŒ€ë¦¬ì¸ì„ ë³´ëƒ„ - ëŒ€ë¦¬ì¸ì˜ í°ì—” ì†ë‹˜ í°(ì£¼ì†Œ)ë¥¼ ë„£ìŒ

**ë¬¸ì§€ê¸°ëŠ” ì…êµ¬ì»·ì„ ë‹´ë‹¹í•˜ê³ , ì†ë‹˜ê³¼ ëŒ€ë¦¬ì¸ì„ ì—°ê²°ì‹œì¼œì£¼ëŠ” ì—­í• **


* ìš”ì•½

1) í•¸ë“œí° - 1. ì†Œì¼“
2) ì‹ë‹¹ ë²ˆí˜¸ë¡œ ì…ì¥ ë¬¸ì˜ - 2. ì„œë²„ ì£¼ì†Œë¡œ Connect ( ì†Œì¼“ì„ í†µí•´ì„œ)

íœ´ëŒ€í°ì„ í†µí•´ ëŒ€ë¦¬ì¸ íœ´ëŒ€í°ê³¼ í†µí™” ê°€ëŠ¥ - ì†Œì¼“ì„ í†µí•´ Session ì†Œì¼“ê³¼ íŒ¨í‚· ì†¡ìˆ˜ì‹  ê°€ëŠ¥

1) ë¬¸ì§€ê¸° êµìœ¡ - 1. Listener ì†Œì¼“ ì¤€ë¹„
2) ë¬¸ì§€ê¸° êµìœ¡ ( ì‹ë‹¹ ë²ˆí˜¸ ì•Œë ¤ì¤Œ ) - 2. Bind (ì„œë²„ ì£¼ì†Œ/Portë¥¼ ì†Œì¼“ì— ì—°ë™)
3) ì˜ì—… ì‹œì‘ - 3. Listen
4) ì•ˆë‚´ - 4. Accept

### ğŸªì‹ë‹¹

DNS (Domain Name System)
www.google.com = 123.1.2.3
ì—¬ëŸ¬ê°œì˜ ipë¥¼ ê°€ì§ˆìˆ˜ìˆìŒ
dnsì„œë²„ëŠ” ë„¤íŠ¸ì›Œí¬ ë§ì•ˆì— í•˜ë‚˜ ë” ìˆë‹¤

IPEndPoint - ì‹ë‹¹ ìµœì¢… ì£¼ì†Œ
AddressFamily - IPv4, IPv6ì„ íƒí•˜ëŠ” ê²ƒ , endPointì— ë“¤ì–´ê°€ ìˆìŒ
SocketType.Stream, ProtocolType.TcpëŠ” ì„¸íŠ¸

clientSocket.Receive()ëŠ” byte[]ë¥¼ ì¸ìë¡œ ë°›ìŒ

Encoding.UTF8.GetString(recvBuff, 0, recvBytes);ëŠ” UTF8 ê·œì•½ìœ¼ë¡œ ì¸ì½”ë”©ì„ í•˜ê³  ìˆê³  ì˜ì–´ëŠ” 1ë°”ì´íŠ¸, í•œê¸€ì€ 2ë°”ì´íŠ¸ë¥¼ ì†Œëª¨í•¨, recvBuff - ë°›ì„ ë¦¬ì‹œë¸Œ, 0 - ì²« ì¸ë±ìŠ¤, recvBytes - í¬ê¸°, stringìœ¼ë¡œ ë°˜í™˜í•¨

ë¦¬ì‹œë¸ŒëŠ” ë°”ì´íŠ¸ë¥¼ ê³µê°„ì„ ë°›ì•„ì„œ ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë³€í™˜í•´ì„œ ë°›ìŒ

ìƒŒë“œëŠ” ìŠ¤íŠ¸ë§ì„ ê·¸ëŒ€ë¡œ ë³´ëƒ„

### ğŸªì†ë‹˜

// ë¬¸ì§€ê¸°í•œí…Œ ì…ì¥ ë¬¸ì˜

socket.Connect()ëŠ” ìƒëŒ€ë°©ì˜ ìµœì¢…ì£¼ì†Œë¥¼ ê¸°ì…

RemoteEndPointëŠ” ì—°ê²°í•œ ë°˜ëŒ€ìª½ ëŒ€ìƒ ì£¼ì†Œë¥¼ ê°€ë¥´í‚´

### ğŸªServerCore

```cs
class Program
{
    static void Main(string[] args)
    {
        // DNS (Domain Name System)
        string host = Dns.GetHostName(); // ë„ë©”ì¸ ì´ë¦„ ì •í•˜ê¸°
        IPHostEntry ipHost = Dns.GetHostEntry(host); // ë„ë©”ì¸ ì´ë¦„ ê¸°ì…
        IPAddress ipAddr = ipHost.AddressList[0]; // ipì£¼ëª¨ ê°€ì ¸ì˜¤ê¸° (ìš°ë¦¬ëŠ” ì²«ë²ˆì§¸êº¼ í•˜ë‚˜ë§Œ ì“¸ê±°ê¸°ë•Œë¬¸ì— 0)
        IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777); // ì£¼ì†Œì™€ ì£¼ì†Œì…êµ¬ ì•Œë ¤ì£¼ê¸°

        // ë¬¸ì§€ê¸°
        Socket listenSocket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp); // ë¬¸ì§€ê¸° ìƒì„±
        // SocketType.Stream, ProtocolType.Tcpì€ ì„¸íŠ¸!
        // Ucpë„ ìˆëŠ”ë° ë””ë”° ë¹ ë¥´ì§€ë§Œ ì•ˆì „ x
        // TcpëŠ” ì•ˆì „ì•ˆì „

        try
        {
            // ë¬¸ì§€ê¸° êµìœ¡
            listenSocket.Bind(endPoint); // Bindí•¨ìˆ˜ë¡œ êµìœ¡(endPintë¥¼ ë„£ì–´ì£¼ì–´ ì£¼ì†Œì™€ ì…êµ¬ ì•Œë ¤ì£¼ê¸°)

            // ì˜ì—… ì‹œì‘
            // BackLog : ìµœëŒ€ ëŒ€ê¸°ìˆ˜
            listenSocket.Listen(10); // Listenìœ¼ë¡œ ì˜ì—…ì‹œì‘

            while (true)
            {
                Console.WriteLine("Listening...");

                // ì†ë‹˜ì„ ì…ì¥ ì‹œí‚¨ë‹¤
                Socket clientSocket = listenSocket.Accept(); // ì…ì¥ì‹œí‚¬ ì†ë‹˜

                // ë°›ëŠ”ë‹¤
                byte[] recvBuff = new byte[1024];
                int recvBytes = clientSocket.Receive(recvBuff); // Receiveë¡œ ë°›ì§€ë§Œ byte[]ê°€ í•„ìš”í•´ì„œ ë§Œë“¤ì–´ì¤Œ
                string recvData = Encoding.UTF8.GetString(recvBuff, 0, recvBytes); // ì¸ì½”ë”©ì„ í•¨ (ì¸ì½”ë”©ì„ ì˜ëª¨ë¥´ê² ìŒ)
                // recvBuff, 0, recvBytesì€ ì „ë‹¬í•  ë‚´ìš©, ì²« ì¸ë±ìŠ¤ ì„¤ì •, ì§„ì§œ ë‚´ìš© ëŒ€ì¶© ì´ëŸ° ëœ»ì¸ë“¯..
                Console.WriteLine($"[From Client] {recvData}");

                // ë³´ë‚¸ë‹¤
                byte[] sendBuff = Encoding.UTF8.GetBytes("Welcome to MMORPG Server!"); // Sendì— í•„ìš”í•œ byte[]
                clientSocket.Send(sendBuff); // Sendë¡œ ë³´ëƒ„

                // ì«“ì•„ë‚¸ë‹¤
                clientSocket.Shutdown(SocketShutdown.Both); // ì´ê±°í•´ì£¼ë©´ ì•ˆì „í•¨. ì•ˆí•´ì¤˜ë„ ë¨
                clientSocket.Close(); // ë¬¸ë‹«ì•„ìš©
            }
        }
        catch(Exception e) // í˜¹ì‹œ ëª¨ë¥¼ ì˜ˆì™¸ì²˜ë¦¬
        {
            Console.WriteLine(e.ToString());
        }
        
    }
}
```


### ğŸªDummyClient

```cs
class Program
{
    static void Main(string[] args)
    {
        while (true)
        {
            // DNS (Domain Name System)
            string host = Dns.GetHostName();
            IPHostEntry ipHost = Dns.GetHostEntry(host);
            IPAddress ipAddr = ipHost.AddressList[0];
            IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777); // ì£¼ì†Œ ì…êµ¬ê°€ ê°™ì•„ì•¼ ë˜ëŠ”ê²Œ í¬ì¸íŠ¸!
            // ì„œë²„ë‘ ê°™ìŒ

            // íœ´ëŒ€í° ì„¤ì •
            Socket socket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);

            try
            {
                // ë¬¸ì§€ê¸°í•œí…Œ ì…ì¥ ë¬¸ì˜
                socket.Connect(endPoint); // Connectë¡œ ë¬¸ì˜ ë“œë ¤ìš”~
                Console.WriteLine($"Connected to {socket.RemoteEndPoint.ToString()}");

                // ë³´ë‚¸ë‹¤
                byte[] sendBuff = Encoding.UTF8.GetBytes("Hello World!");
                int sendBytes = socket.Send(sendBuff); // í´ë¼ëŠ” ë¨¼ì € Sendë¶€í„° ë³´ëƒ„

                // ë°›ëŠ”ë‹¤
                byte[] recvBuff = new byte[1024];
                int recvBytes = socket.Receive(recvBuff); // Receiveë¡œ ë°›ê¸°
                string recvData = Encoding.UTF8.GetString(recvBuff, 0, recvBytes);
                Console.WriteLine($"[From Server] {recvData}");

                // ë‚˜ê°„ë‹¤
                socket.Shutdown(SocketShutdown.Both);
                socket.Close();
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }

            Thread.Sleep(500);
        }
    }
}
```










