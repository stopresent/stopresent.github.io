---
layout: single
title: "Threadìƒì„±"
categories: Server
tags: Server
author_profile: false
sidebar:
  nav: "docs"
---

## ğŸ™‡â€â™€ï¸Thread

* threadëŠ” ì¼ê¾¼!
* cpuê°€ ì˜í˜¼ì„ ë„£ì–´ì£¼ë©´ ì‘ë™!
* ê¸°ë³¸ì ìœ¼ë¡œforegroundì´ë‹¤
  * backgoundë©´ ë©”ì¸í•¨ìˆ˜ê°€ ëë‚˜ë©´ ìë™ì ìœ¼ë¡œ ì“°ë ˆë“œê°€ ì¢…ë£Œ
* threadë“¤ì´ ë™ì‹œ ì‹¤í–‰ê°€ëŠ¥í•œ ìˆ˜ëŠ” cpu ì½”ì–´ ê°œìˆ˜ì™€ ê°™ë‹¤

### ğŸªThread

```cs
class Program
{
    static void MainThread()
    {
        while(true)
            Console.WriteLine("Hello Thread!");
    }

    static void Main(string[] args)
    {
        Thread t = new Thread(MainThread); // threadì˜ ë©”ì¸ í•¨ìˆ˜ë¥¼ ì„¤ì •í•´ ì£¼ì–´ì•¼ ë¨ (tê°€ í• ì¼!)
        t.IsBackground = true; // të¥¼ backgroundë¡œ ì„¤ì •
        t.Start(); // tê°€ ì¼ì„ ì‹œì‘
        Console.WriteLine("Hello World!");
    }
}
```

* ì“°ë ˆë“œì˜ ë©”ì¸í•¨ìˆ˜ë¥¼ ë§Œë“¤ê¸°
* ì“°ë ˆë“œë¥¼ ìƒì„±ì‹œ ë©”ì¸í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë„£ì–´ì£¼ì–´ì•¼ í•¨
* startí•¨ìˆ˜ë¡œ ì¼ì„ ì‹œì‘
* ê¸°ë³¸ì ìœ¼ë¡œ IsBackground = false ìƒíƒœ

### ğŸªJoin

```cs
Thread t = new Thread(MainThread);
t.Name = "Test Thread";
t.IsBackground = true;
t.Start();
Console.WriteLine("Waiting for Thread!");
t.Join();
Console.WriteLine("Hello World!");
```

ìœ„ì— ê²°ê³¼ëŠ” Hello Thread!ê°€ ë¬´í•œ ë°˜ë³µëœë‹¤ (Waiting for Thread! ì¶œë ¥ x)

* Join í•¨ìˆ˜
  * ì“°ë ˆë“œì˜ ì¼ì´ ëë‚  ë•Œ ê¹Œì§€ ê¸°ë‹¤ë¦° í›„ ë‹¤ìŒ ì¤„ ì‹¤í–‰
  * `t.Start();`ê°€ ëë‚œ ë’¤ `Console.WriteLine("Hello World!");`ê°€ ì‹¤í–‰ë¨

Joinì´ ì—†ìœ¼ë©´ ë©”ì¸í•¨ìˆ˜ê°€ ìš°ì„ !

### ğŸªThreadPool

ì“°ë ˆë“œí’€ì€ ì§ì›ì„ ì´ë¯¸ ëª‡ëª…ë‘ê³  ë‹¨ê¸°ì•Œë°”ë¥¼ í•  ì¸ë ¥ì„ íˆ¬ì…í•œë‹¤
íˆ¬ì…í•œ ì¸ë ¥ì´ ì¼ì„ ë§ˆì¹˜ê³  ì˜¤ë©´ ê·¸ì œì„œì•¼ ë‹¤ì‹œ ì¸ë ¥ì„ íˆ¬ì…í•œë‹¤
ì§§ì€ ì¼ê°ì„ ì¤€ë‹¤ë©´ íš¨ìœ¨ì´ ì¢‹ì§€ë§Œ ê·¸ë ‡ì§€ì•Šë‹¤ë©´ ì¼ê¾¼ì´ ë¶€ì¡±í•´ì ¸ì„œ ë¨¹í†µì´ ë ìˆ˜ìˆë‹¤

* ThreadPoolë¡œ êµ¬í•œ ì¸ë ¥ì€ ê¸°ë³¸ì ìœ¼ë¡œ Backgroundë¡œ ëŒì•„ê°„ë‹¤!
* ì“°ë ˆë“œí’€ë¡œ ë‹¨ê¸° ì•Œë°”êµ¬í•˜ê¸°!

`ThreadPool.QueueUserWorkItem(MainThread);`

`static void MainThread(Object state) { }`ì²˜ëŸ¼ Objectë¥¼ ì¸ìë¡œ ë°›ì•„ì•¼ ë¨

* **ì“°ë ˆë“œí’€ì€ ê°€ë²¼ìš´ ì¼ì„ ì‹œí‚¤ëŠ” ê²ƒì´ ì¢‹ë‹¤!**

```cs
ThreadPool.SetMinThreads(1, 1);
ThreadPool.SetMaxThreads(5, 5);

for (int i = 0; i < 5; i++)
    ThreadPool.QueueUserWorkItem((obj) => { while (true) { } });
    
ThreadPool.QueueUserWorkItem(MainThread);
```

ì´ë ‡ê²Œ ëœë‹¤ë©´ ì¼ê¾¼ ë‹¤ì„¯ëª…ì´ `(obj) => { while (true) { } }`ë¶€ë¶„ì—ì„œ ë‚˜ì˜¤ì§ˆ ëª»í•˜ê³ , ê·¸ ë’¤ `ThreadPool.QueueUserWorkItem(MainThread);`ì„ ì‹¤í–‰í•  ì¼ê¾¼ì´ ì—†ì–´ì§„ë‹¤
ì¼ê¾¼ì´ ì—†ìœ¼ë¯€ë¡œ í”„ë¡œê·¸ë¨ì´ ë¨¹í†µì´ ë¨!

### ğŸªTask

* ì§ì›ì„ ê³ ìš©í•œë‹¤ê¸° ë³´ë‹¤ëŠ” ì§ì›ì´ í•  ì¼ì„ ì •ì˜í•´ì„œ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ëœ»

```cs
ThreadPool.SetMinThreads(1, 1);
ThreadPool.SetMaxThreads(5, 5);

for (int i = 0; i < 5; i++)
{
    Task t = new Task(() => { while (true) { } }, TaskCreationOptions.LongRunning);
    t.Start();
}

ThreadPool.QueueUserWorkItem(MainThread);
```

* TaskëŠ” ActionëŒ€ë¦¬ìë¥¼ ì¸ìë¡œ ë°›ìŒ
* ë‘ë²ˆì§¸ ì¸ìë¡œ TaskCreationOptions.LongRunningëŠ” í•¨ìˆ˜ê°€ ì˜¤ë˜ê±¸ë¦°ë‹¤ëŠ”ê²ƒì„ ì•Œë¦¼
  * ì“°ë ˆë“œ í’€ì—ì„œ ì¸ë ¥ì„ ì–»ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ ë³„ë„ ì²˜ë¦¬ê°€ ë¨
* ë³´í†µ ì“°ë ˆë“œí’€ì´ë‚˜ í…ŒìŠ¤í¬ë¥¼ ì‚¬ìš© (ì“°ë ˆë“œë¥¼ ì§ì ‘ ìƒì„±í•˜ëŠ” ì¼ì€ ë“œë¬¼ë‹¤)



