---
layout: single
title: "λ³µν•©μΈλ±μ¤"
categories: DB
tags: DB
author_profile: false
sidebar:
  nav: "docs"
---


## π™‡β€β™€οΈλ³µν•© μΈλ±μ¤


`USE Northwind;`


* μ£Όλ¬Έ μƒμ„Έ μ •λ³΄λ¥Ό μ‚΄ν΄λ³΄μ

```
SELECT *
FROM [Order Details]
ORDER BY OrderID;
```


- μ„μ‹ ν…μ¤νΈ ν…μ΄λΈ”μ„ λ§λ“¤κ³  λ°μ΄ν„° λ³µμ‚¬ν•λ‹¤

```
SELECT *
INTO TestOrderDetails
FROM [Order Details];

SELECT *
FROM TestOrderDetails
```


- λ³µν• μΈλ±μ¤ μ¶”κ°€

```
CREATE INDEX Index_TestOrderDetails
ON TestOrderDetails(OrderID, ProductID);
```


- μΈλ±μ¤ μ •λ³΄ μ‚΄ν΄λ³΄κΈ°

`EXEC sp_helpindex 'TestOrderDetails';`



- (OrderID, ProductID)? OrderID?, ProductID?
- INDEX SCAN (INDEX FULL SCAN) -> BAD
- INDEX SEEK -> GOOD



### πμΈλ±μ¤ μ μ© ν…μ¤νΈ


* μΈλ±μ¤ μ μ© ν…μ¤νΈ 1 -> GOOD

```
SELECT *
FROM TestOrderDetails
WHERE OrderID = 10248 AND ProductID = 11;
```


- μΈλ±μ¤ μ μ© ν…μ¤νΈ 2 -> GOOD

```
SELECT *
FROM TestOrderDetails
WHERE ProductID = 11 AND OrderID = 10248;
```


- μΈλ±μ¤ μ μ© ν…μ¤νΈ 3 -> GOOD

```
SELECT *
FROM TestOrderDetails
WHERE OrderID = 10248;
```


- μΈλ±μ¤ μ μ© ν…μ¤νΈ 4 -> BAD

```
SELECT *
FROM TestOrderDetails
WHERE ProductID = 11;
```


- INDEX μ •λ³΄

`DBCC IND('Northwind','TestOrderDetails', 2);`


```
 		  880
832 840 841 842 843 844
```

`DBCC PAGE('Northwind', 1, 832, 3);`



- λ”°λΌμ„ μΈλ±μ¤(A, B) μ‚¬μ©μ¤‘μ΄λΌλ©΄ μΈλ±μ¤(A) μ—†μ–΄λ„ λ¬΄λ°©
- ν•μ§€λ§ Bλ΅λ„ κ²€μƒ‰μ΄ ν•„μ”ν•λ©΄ -> μΈλ±μ¤(B)λ” λ³„λ„λ΅ κ±Έμ–΄μ¤μ•Ό ν•¨

- μΈλ±μ¤λ” λ°μ΄ν„°κ°€ μ¶”κ°€/κ°±μ‹ /μ‚­μ  μ μ§€λμ–΄μ•Ό ν•¨
- λ°μ΄ν„° 50κ°λ¥Ό κ°•μ λ΅ λ„£μ–΄λ³΄μ.
- 10248/11 10387/24


```
DECLARE @i INT = 0;
WHILE @i < 50
BEGIN
	INSERT INTO TestOrderDetails
	VALUES (10248, 100 + @i, 10, 1, 0);
	SET @i = @i + 1;
END
```


- INDEX μ •λ³΄

`DBCC IND('Northwind','TestOrderDetails', 2);`

881μ΄λΌλ” κ²ƒμ΄ μƒκΉ€, 832 λ‹¤μμ— 881μ„, 832μ λ°μ΄ν„°κ°€ λ„λ¬΄ λ§μ•„μ Έμ„ λ‘λ΅ μΌκ°  κ²ƒμ΄λ‹¤.


```
         		 880
832 [881] 840 841 842 843 844
```
`DBCC PAGE('Northwind', 1, 832, 3);`
`DBCC PAGE('Northwind', 1, 881, 3);`


**κ²°λ΅ : νμ΄μ§€ μ—¬μ  κ³µκ°„μ΄ μ—†λ‹¤λ©΄ -> νμ΄μ§€ λ¶„ν• (SPLIT) λ°μƒ**



### πμΈλ±μ¤ κ°€κ³µ ν…μ¤νΈ


**κ°€κ³µ ν…μ¤νΈ**

```
SELECT LastName
INTO TestEmployees
FROM Employees;

SELECT * FROM TestEmployees;
```


- μΈλ±μ¤ μ¶”κ°€

```
CREATE INDEX Index_TestEmployees
ON TestEmployees(LastName);
```


- INDEX SCAN -> BAD

```
SELECT *
FROM TestEmployees
WHERE SUBSTRING(LastName, 1, 2) = 'Bu';
```
SUBSTRINGμ€ μΈλ±μ¤λ¥Ό ν™μ©ν•μ§€ λ»ν•λ‹¤


- INDEX SEEK -> GOOD

```
SELECT *
FROM TestEmployees
WHERE LastName LIKE 'Bu%';
```
μΈλ±μ¤λ¥Ό μ‚¬μ©ν•κ³  μ‹¶μΌλ©΄ LIKEλ¥Ό μ‚¬μ© ν•΄μ•Όλ¨


### π

**μ¤λμ κ²°λ΅ **
- λ³µν•© μΈλ±μ¤(A, B)λ¥Ό μ‚¬μ© ν•  λ• μμ„ μ£Όμ (A->B μμ„ κ²€μƒ‰)
- μΈλ±μ¤ μ‚¬μ© μ‹, λ°μ΄ν„° μ¶”κ°€λ΅ μΈν•΄ νμ΄μ§€ μ—¬μ  κ³µκ°„μ΄ μ—†μΌλ©΄ SPLIT
- ν‚¤ κ°€κ³µν•  λ• μ£Όμ!
